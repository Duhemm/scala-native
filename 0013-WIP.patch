From 3d8c3deb99d98cf68b484c4f7da358165481a1fe Mon Sep 17 00:00:00 2001
From: Martin Duhem <martin.duhem@gmail.com>
Date: Thu, 8 Dec 2016 07:43:03 +0100
Subject: [PATCH 13/13] WIP

---
 .../pass/GlobalBoxingEliminationBenchmark.scala    | 25 ++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 tools/src/test/scala/scala/scalanative/optimizer/pass/GlobalBoxingEliminationBenchmark.scala

diff --git a/tools/src/test/scala/scala/scalanative/optimizer/pass/GlobalBoxingEliminationBenchmark.scala b/tools/src/test/scala/scala/scalanative/optimizer/pass/GlobalBoxingEliminationBenchmark.scala
new file mode 100644
index 0000000..35e5e3d
--- /dev/null
+++ b/tools/src/test/scala/scala/scalanative/optimizer/pass/GlobalBoxingEliminationBenchmark.scala
@@ -0,0 +1,25 @@
+package scala.scalanative
+package optimizer
+package pass
+
+import org.scalatest._
+
+class CopyPropagationBenchmark extends BenchmarkSpec with Matchers {
+
+  "Copy propagation" should "not degrade performance" in {
+    val baseDriver     = Driver().remove(GlobalBoxingElimination)
+    val improvedDriver = Driver()
+
+    benchmark("A$",
+              baseDriver,
+              improvedDriver,
+              20,
+              """object A {
+                |  def main(args: Array[String]): Unit =
+                |    println("Hello, world!")
+                |}""".stripMargin) {
+      case (base, improved) =>
+        improved.avgNs should be < base.avgNs
+    }
+  }
+}
-- 
2.9.3 (Apple Git-75)

